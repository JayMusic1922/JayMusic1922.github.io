<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>The Family Store</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #fdfdfd; }
    h1 { text-align: center; color: #333; }
    .pulsera { border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 10px; }
    button { padding: 10px; margin: 5px; border-radius: 8px; cursor: pointer; }
    .btn { background: #333; color: white; }
    .btn:hover { background: #555; }

body::before {
  content: "";
  position: fixed;
  inset: 0;                     /* top:0; right:0; bottom:0; left:0; */
  background: url("fondo.png") center/cover no-repeat;
  filter: blur(8px) brightness(0.7);
  transform: scale(1.05);       /* evitar bordes visibles por el blur */
  z-index: -2;
  will-change: transform, filter;
}

/* Layer: oscurecer/atenuar el fondo para mejor contraste */
body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.25); /* ajusta la opacidad a tu gusto */
  z-index: -1;
}

/* Tu contenedor principal debe estar por encima */
.contenedor {
  position: relative;
  z-index: 1;
  /* si quieres que la tarjeta tambi√©n tenga un ligero blur por detr√°s */
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(2px); /* bonito toque; no lo usa todo navegador, pero est√° bien */
  -webkit-backdrop-filter: blur(2px);
  /* resto del estilo ya existente */
}


  </style>
</head>
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>The Family Store</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f7f7f7;
      color: #222;
    }

    .contenedor {
      max-width: 700px;
      margin: 40px auto;
      background: rgba(255, 255, 255, 0.95);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    .pulsera {
      border: 2px solid #ddd;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 10px;
      background: #fff;
    }

    .pulsera h3 {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 0;
    }

    .btn-borrar {
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      color: #d32f2f;
    }

    .decoracion {
      margin: 10px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .contador {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .contador button {
      width: 30px;
      height: 30px;
      border: none;
      border-radius: 5px;
      background: #f57c00;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }

    .contador button:hover {
      background: #ef6c00;
    }

    .contador input {
      width: 40px;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
      height: 30px;
    }

    .subtotal {
      margin-top: 10px;
      font-weight: bold;
      text-align: right;
    }

    #total {
      font-size: 22px;
      font-weight: bold;
      margin-top: 20px;
      text-align: center;
    }

    #agregarPulsera {
      display: block;
      margin: 0 auto;
      padding: 10px 20px;
      background: #388e3c;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }

    #agregarPulsera:hover {
      background: #2e7d32;
    }
  </style>
</head>
<body>
   <div class="contenedor">
    <h1><img src="logo.png" alt="logo" style="height:50px; vertical-align:middle;"> The Family Store</h1>
    <p>Arma tus pulseras con las decoraciones que quieras. üß°üñ§ </p> 

    <div id="pulseras">
      <div class="pulsera">
        <h3>Pulsera 1 <button class="btn-borrar">üóëÔ∏è</button></h3>

        <div class="decoracion">
          <span>Coraz√≥n ($2000)</span>
          <div class="contador">
            <button class="menos">-</button>
            <input type="text" value="0" readonly data-precio="2000">
            <button class="mas">+</button>
          </div>
        </div>

        <div class="decoracion">
          <span>Estrella ($1500)</span>
          <div class="contador">
            <button class="menos">-</button>
            <input type="text" value="0" readonly data-precio="1500">
            <button class="mas">+</button>
          </div>
        </div>

        <div class="decoracion">
          <span>Inicial personalizada ($1800)</span>
          <div class="contador">
            <button class="menos">-</button>
            <input type="text" value="0" readonly data-precio="1800">
            <button class="mas">+</button>
          </div>
        </div>

        <div class="decoracion">
          <span>Dije varios ($2500)</span>
          <div class="contador">
            <button class="menos">-</button>
            <input type="text" value="0" readonly data-precio="2500">
            <button class="mas">+</button>
          </div>
        </div>
        
 <div style="margin-top:15px;">
    <label>Detalles (color, grosor, etc):</label>
    <textarea class="notas" rows="2" 
              style="width:100%; border-radius:8px; padding:8px; margin-top:5px; border:1px solid #ccc; resize:vertical;"></textarea>
  </div>
        <div class="subtotal">Subtotal: $2000 COP</div>
      </div>
    </div>

    <button id="agregarPulsera">‚ûï Agregar otra pulsera</button>
    <div id="total">Total: $2000 COP</div>

     <div style="margin-top:20px; text-align:center;">
  <button onclick="descargarPDF()" 
          style="background:#4CAF50;color:white;padding:10px 15px;margin:5px;border:none;border-radius:8px;cursor:pointer;">
    üìÑ Descargar Vale en PDF
  </button>

  <button onclick="enviarWhatsApp()" 
          style="background:#25D366;color:white;padding:10px 15px;margin:5px;border:none;border-radius:8px;cursor:pointer;">
    üí¨ Enviar por WhatsApp
  </button>
</div>
  </div>

 <script>
const MANO_OBRA = 2000; // valor fijo de mano de obra

// üîπ Funci√≥n para extraer nombre y precio de cada item
function obtenerNombreYPrecio(deco, input) {
  const nombre = deco.querySelector("label")?.innerText || "Producto";
  const precio = parseInt(input.dataset.precio || "0", 10) || 0;
  return { nombre, precio };
}

// üîπ Funci√≥n que calcula el resumen completo
function generarResumenTexto() {
  let resumen = "Resumen de pedido - The Family Store\n\n";
  let totalGeneral = 0;

  const pulseras = document.querySelectorAll(".pulsera");

  if (pulseras.length === 0) {
    resumen += "No hay pulseras seleccionadas.\n\n";
  }

  pulseras.forEach((pulsera, i) => {
    resumen += `Pulsera ${i + 1}:\n`;
    let subtotalPulsera = MANO_OBRA;

    // recorrer todos los items de la pulsera
    pulsera.querySelectorAll(".decoracion").forEach(deco => {
      const input = deco.querySelector("input");
      if (!input) return;

      const cantidad = parseInt(input.value || "0", 10) || 0;
      if (cantidad <= 0) return;

      const { nombre, precio } = obtenerNombreYPrecio(deco, input);
      const subtotalItem = cantidad * precio;

      resumen += ` - ${nombre} ($${precio.toLocaleString("es-CO")}) x${cantidad} = $${subtotalItem.toLocaleString("es-CO")} COP\n`;
      subtotalPulsera += subtotalItem;
    });

    // notas escritas por el cliente
    const notas = pulsera.querySelector(".notas")?.value.trim();
    if (notas) {
      resumen += `   Notas del cliente: ${notas}\n`;
    }

    resumen += ` Mano de obra: $${MANO_OBRA.toLocaleString("es-CO")} COP\n`;
    resumen += ` Subtotal Pulsera ${i + 1}: $${subtotalPulsera.toLocaleString("es-CO")} COP\n\n`;
    totalGeneral += subtotalPulsera;
  });

  resumen += `Total: $${totalGeneral.toLocaleString("es-CO")} COP\n`;

  return { texto: resumen, total: totalGeneral };
}

// üîπ Actualiza el √°rea de resultados en pantalla
function actualizarResumen() {
  const { texto } = generarResumenTexto();
  document.getElementById("resultado").textContent = texto;
}

// üîπ Bot√≥n para enviar a WhatsApp
function enviarWhatsApp() {
  const { texto } = generarResumenTexto();
  const telefono = "573001234567"; // ‚Üê cambia a tu n√∫mero
  const url = `https://wa.me/${telefono}?text=${encodeURIComponent(texto)}`;
  window.open(url, "_blank");
}

// üîπ Bot√≥n para generar PDF
function generarPDF() {
  const { texto } = generarResumenTexto();
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFont("helvetica", "normal");
  doc.setFontSize(12);
  doc.text(texto, 10, 10);
  doc.save("vale_pedido.pdf");
}
</script>

  <!-- Botones de exportar -->


<!-- Librer√≠a jsPDF (para generar PDF) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
/* --- CONFIG --- */
const WHATSAPP_NUM = "573014348004"; // <- pon tu n√∫mero en formato internacional
const MANO_OBRA = 2000; // si en tu proyecto usas otro valor, c√°mbialo aqu√≠

/* --- Helpers --- */
// Extrae nombre y precio desde la estructura: <div class="decoracion"><span>Nombre ($precio)</span> ... <input data-precio="..."></div>
function obtenerNombreYPrecio(deco, input) {
  // nombre desde el <span>
  const span = deco.querySelector("span");
  let textoSpan = span ? span.textContent.trim() : "";
  // quitar el "( $... )" para sacar solo el nombre
  const nombre = textoSpan.replace(/\s*\(\s*\$?[0-9.,]+\s*\)\s*$/g, "").trim() || (input.dataset?.nombre || "Decoracion");

  // precio: primero intentar data-precio, si no, parsear del span
  let precio = 0;
  if (input && input.dataset && input.dataset.precio) {
    precio = parseInt(input.dataset.precio, 10) || 0;
  } else {
    const m = textoSpan.match(/\$?([0-9.,]+)/);
    if (m) {
      precio = parseInt(m[1].replace(/\./g,"").replace(/,/g,""), 10) || 0;
    }
  }

  return { nombre, precio };
}

// Limpia texto para PDF (jsPDF a veces no soporta bien caracteres UTF-8)
// Solo se usa antes de crear el PDF; WhatsApp recibir√° el texto original con acentos.
function sanearParaPDF(texto) {
  // normalizar y quitar diacr√≠ticos (√° -> a), luego eliminar caracteres no ascii imprimibles
  let t = texto.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
  // permitir caracteres b√°sicos, n√∫meros, signos de puntuaci√≥n, espacios y saltos de l√≠nea
  t = t.replace(/[^\x20-\x7E\n]/g, "");
  return t;
}

/* --- Generar resumen (texto con nombres, cantidades y subtotales) --- */
function generarResumenTexto() {
  let resumen = "Resumen de pedido - The Family Store\n\n";
  let totalGeneral = 0;

  const pulseras = document.querySelectorAll(".pulsera");
  if (pulseras.length === 0) {
    resumen += "No hay pulseras seleccionadas.\n\n";
  }

 pulseras.forEach((pulsera, i) => {
  resumen += `Pulsera ${i+1}:\n`;
  let subtotalPulsera = MANO_OBRA;

  // recorrer las decoraciones
  pulsera.querySelectorAll(".decoracion").forEach(deco => {
    const input = deco.querySelector("input");
    if (!input) return;
    const cantidad = parseInt(input.value || "0", 10) || 0;
    if (cantidad <= 0) return;

    const { nombre, precio } = obtenerNombreYPrecio(deco, input);
    const subtotalItem = cantidad * precio;
    resumen += ` - ${nombre} ($${precio.toLocaleString("es-CO")}) x${cantidad} = $${subtotalItem.toLocaleString("es-CO")} COP\n`;
    subtotalPulsera += subtotalItem;
  });

  // üëá Agregar notas escritas por el cliente
  const notas = pulsera.querySelector(".notas")?.value.trim();
  if (notas) {
    resumen += `   Notas del cliente: ${notas}\n`;
  }

  resumen += ` Mano de obra: $${MANO_OBRA.toLocaleString("es-CO")} COP\n`;
  resumen += ` Subtotal Pulsera ${i+1}: $${subtotalPulsera.toLocaleString("es-CO")} COP\n\n`;
  totalGeneral += subtotalPulsera;
});


    resumen += ` Mano de obra: $${MANO_OBRA.toLocaleString("es-CO")} COP\n`;
    resumen += ` Subtotal Pulsera ${i+1}: $${subtotalPulsera.toLocaleString("es-CO")} COP\n\n`;
    totalGeneral += subtotalPulsera;
  });

  resumen += `Total: $${totalGeneral.toLocaleString("es-CO")} COP\n`;
  return { texto: resumen, total: totalGeneral };
}

/* --- Descargar PDF (usa jsPDF) --- */
function descargarPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ unit: "pt", format: "a4" });

  const resumenObj = generarResumenTexto();
  // Sanear para evitar caracteres raros en el PDF
  const contenido = sanearParaPDF(resumenObj.texto);

  // dibujar texto en PDF con saltos de l√≠nea autom√°ticos
  const lineHeight = 14;
  let x = 40;
  let y = 40;
  const pageHeightLimit = 800;

  const lines = doc.splitTextToSize(contenido, 520);
  doc.setFont("helvetica", "normal");
  doc.setFontSize(12);
  for (let i = 0; i < lines.length; i++) {
    if (y > pageHeightLimit) {
      doc.addPage();
      y = 40;
    }
    doc.text(lines[i], x, y);
    y += lineHeight;
  }

  doc.save("vale_compra.pdf");
}

/* --- Enviar por WhatsApp (abre conversaci√≥n al n√∫mero fijo) --- */
function enviarWhatsApp() {
  const resumenObj = generarResumenTexto();
  const mensaje = resumenObj.texto; // NO lo saneamos: WhatsApp admite UTF-8 y acentos
  const numero = WHATSAPP_NUM.replace(/\D/g, "");
  const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensaje)}`;
  window.open(url, "_blank");
}

/* --- Exponer en window si quieres (opcional) ) --- */
window.generarResumenTexto = generarResumenTexto;
window.descargarPDF = descargarPDF;
window.enviarWhatsApp = enviarWhatsApp;
</script>

</body>

</html>


















