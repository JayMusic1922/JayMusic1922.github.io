<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>The Family Store</title>
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      color: #222;
    }

    /* Fondo difuminado */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: url("fondo.png") center/cover no-repeat;
      filter: blur(8px) brightness(0.7);
      transform: scale(1.05);
      z-index: -2;
    }
    body::after {
      content: "";
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.25);
      z-index: -1;
    }

    .contenedor {
      max-width: 700px;
      margin: 40px auto;
      background: rgba(255,255,255,0.9);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
      position: relative;
      z-index: 1;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    .pulsera {
      border: 2px solid #ddd;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 10px;
      background: #fff;
    }

    .pulsera h3 {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 0;
    }

    .btn-borrar {
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      color: #d32f2f;
    }

.decoracion {
        border: 1px solid #f0f0f0;
        padding: 8px 10px;
        margin: 10px 0;
        border-radius: 6px;
        background: #fafafa;
    }

    .decoracion summary {
        cursor: pointer;
        font-weight: bold;
        padding: 5px 0;
        list-style: none; /* Oculta la flecha por defecto */
        display: flex;
        align-items: center;
        /* Estilo personalizado de flecha */
    }
    .decoracion summary::before {
        content: 'â–¶ï¸'; /* Flecha derecha */
        margin-right: 10px;
        transition: transform 0.2s;
    }
    .decoracion[open] summary::before {
        content: 'ğŸ”½'; /* Flecha abajo */
        transform: rotate(90deg);
    }
    
    .contenido-decoracion {
        padding-top: 10px;
        border-top: 1px solid #eee;
    }

.item-decoracion {
    display: flex; 
    /* Volvemos a space-between para que la PIEDRERÃA use todo el ancho */
    justify-content: space-between; 
    
    align-items: center; 
    margin-bottom: 15px; 
    padding: 5px 0;
    border-bottom: 1px dotted #ccc;
}

/* AÃ±ade esta nueva regla a tu bloque <style> */
.item-centrado {
    /* Centra el contenido en el medio */
    justify-content: center; 
    /* AÃ±ade un espacio controlado entre los dos componentes (grupo-visual y contador) */
    gap: 40px; 
}

/* Si el nombre y la imagen estÃ¡n separados, ajustamos el espaciado entre los elementos */
.item-decoracion > span, 
.item-decoracion > img,
.item-decoracion > .contador {
    align-self: center; /* Asegura que cada hijo se centre a sÃ­ mismo */
}

/* AÃ±ade esta nueva regla a tu bloque <style> */
.grupo-visual {
    display: flex;
    flex-direction: column; 
    align-items: center; 
    gap: 5px; 
}

.contador {
    display: flex;
    align-items: center;
    gap: 5px;
}

    .decoracion {
      margin: 10px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .contador {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .contador button {
      width: 30px;
      height: 30px;
      border: none;
      border-radius: 5px;
      background: #f57c00;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }

    .contador button:hover {
      background: #ef6c00;
    }

    .contador input {
      width: 40px;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
      height: 30px;
    }

    .subtotal {
      margin-top: 10px;
      font-weight: bold;
      text-align: right;
    }

    #total {
      font-size: 22px;
      font-weight: bold;
      margin-top: 20px;
      text-align: center;
    }

    #agregarPulsera {
      display: block;
      margin: 0 auto;
      padding: 10px 20px;
      background: #388e3c;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }

    #agregarPulsera:hover {
      background: #2e7d32;
    }

    .botones-exportar {
      margin-top: 20px;
      text-align: center;
    }

    .botones-exportar button {
      background: #4CAF50;
      color: white;
      padding: 10px 15px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .botones-exportar button:hover {
      background: #45a049;
    }

    .botones-exportar .whatsapp {
      background: #25D366;
    }
    .botones-exportar .whatsapp:hover {
      background: #1ebe5d;
    }
  </style>
</head>
<body>
  <div class="contenedor">
    <h1><img src="logo.png" alt="logo" style="height:150px; vertical-align:middle;"> The Family Store</h1>
    <p>Cada pulsera tiene un costo fijo de $3.000 COP Sientete libre y Arma tus pulseras con las decoraciones que quieras. ğŸ§¡ğŸ–¤</p>

    <div id="pulseras">
      <div class="pulsera">
        <h3>Pulsera <button class="btn-borrar">ğŸ—‘ï¸</button></h3>

        <details class="decoracion" ...>
Â  <summary> Piedreria ($100) </summary>
Â  Â  <div class="contenido-decoracion">

      Â  Â  Â  Â  Â  Â  Â  Â  <div class="item-decoracion"> 
Â  Â  Â  Â  Â  Â  <img src="letras.png" alt="letras" style="height:100px;">
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="100" data-nombre="letras">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  <div class="item-decoracion"> 
Â  Â  Â  Â  Â  Â  <img src="circulo_corazon.png" alt="circulo_corazon" style="height:100px;">
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="100" data-nombre="circulo_corazon">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

       Â  Â  Â  Â  Â  Â  Â  <div class="item-decoracion"> 
Â  Â  Â  Â  Â  Â  <img src="diamantes.png" alt="diamantes" style="height:100px;">
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="100" data-nombre="diamantes">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

       Â  Â  Â  Â  Â  Â  Â  <div class="item-decoracion"> 
Â  Â  Â  Â  Â  Â  <img src="forma_corazon.png" alt="forma_corazon" style="height:100px;">
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="100" data-nombre="forma_corazon">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

       Â  Â  Â  Â  Â  Â  Â  <div class="item-decoracion"> 
Â  Â  Â  Â  Â  Â  <img src="forma_craneo.png" alt="forma_craneo" style="height:100px;">
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="100" data-nombre="forma_craneo">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

       Â  Â  Â  Â  Â  Â  Â  <div class="item-decoracion"> 
Â  Â  Â  Â  Â  Â  <img src="forma_rosa.png" alt="forma_rosa" style="height:100px;">
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="100" data-nombre="forma_rosa">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

       Â  Â  Â  Â  Â  Â  Â  <div class="item-decoracion"> 
Â  Â  Â  Â  Â  Â  <img src="numeros.png" alt="numeros" style="height:100px;">
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="100" data-nombre="numeros">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

       Â  Â  Â  Â  Â  Â  Â  <div class="item-decoracion"> 
Â  Â  Â  Â  Â  Â  <img src="rosa_ceniza.png" alt="rosa_ceniza" style="height:100px;">
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="100" data-nombre="rosa_ceniza">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

       Â  Â  Â  Â  Â  Â  Â  <div class="item-decoracion"> 
Â  Â  Â  Â  Â  Â  <img src="rosa_plata.png" alt="rosa_plata" style="height:100px;">
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="100" data-nombre="rosa_plata">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

       Â  Â  Â  Â  Â  Â  Â  <div class="item-decoracion"> 
Â  Â  Â  Â  Â  Â  <img src="solidos.png" alt="solidos" style="height:100px;">
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="100" data-nombre="solidos">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  </div>
</details>

      <details class="decoracion">
Â  <summary>Dijes</summary>
Â  Â  <div class="contenido-decoracion">

Â  Â  Â  Â  <div class="item-decoracion item-centrado"> Â  Â  Â  Â  Â  
            <div class="grupo-visual">
Â  Â  Â  Â  Â  Â  Â  <span>($1000)</span> 
Â  Â  Â  Â  Â  Â  Â  <img src="dijes.png" alt="dijes" style="height:100px;">
            </div>
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  <div class="contador">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="menos">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" value="0" readonly data-precio="1000" data-nombre="Dijes">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="mas">+</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  </div>
</details>


        <div style="margin-top:15px;">
          <label>Detalles (color, grosor, etc):</label>
          <textarea class="notas" rows="2"
                    style="width:100%; border-radius:8px; padding:8px; margin-top:5px; border:1px solid #ccc; resize:vertical;"></textarea>
        </div>

        <div class="subtotal">Subtotal: $2000 COP</div>
      </div>
    </div>

    <button id="agregarPulsera">â• Agregar otra pulsera</button>
    <div id="total">Total: $3000 COP</div>

    <div class="botones-exportar">
      <button onclick="descargarPDF()">ğŸ“„ Descargar Vale en PDF</button>
      <button class="whatsapp" onclick="enviarWhatsApp()">ğŸ’¬ Enviar por WhatsApp</button>
    </div>
  </div>

<script>
const WHATSAPP_NUM = "573014348004"; 
const MANO_OBRA = 3000;

/* Extraer nombre y precio de forma robusta (usando data attributes del input) */
function obtenerNombreYPrecio(input) {
Â  // El nombre se lee directamente de input.dataset.nombre (e.g., "Letras")
Â  const nombre = input.dataset.nombre || "ArtÃ­culo sin nombre";
Â  const precio = parseInt(input.dataset.precio || "0", 10);
Â  return { nombre, precio };
}

/* Actualizar totales en pantalla (CORREGIDO) */
function actualizarTotales() {
Â  let totalGeneral = 0;
Â  document.querySelectorAll(".pulsera").forEach((pulsera, i) => {
Â  Â  let subtotalPulsera = MANO_OBRA;

Â  Â  // CAMBIO CLAVE: Iterar sobre TODOS los inputs de cantidad dentro de la pulsera
Â  Â  pulsera.querySelectorAll(".item-decoracion input[type='text']").forEach(input => {
Â  Â  Â  const cantidad = parseInt(input.value || "0", 10);
Â  Â  Â  // La funciÃ³n obtenerNombreYPrecio ahora solo necesita el input
Â  Â  Â  const { precio } = obtenerNombreYPrecio(input);
Â  Â  Â  subtotalPulsera += cantidad * precio;
Â  Â  });
Â  Â  
Â  Â  const subtotalDiv = pulsera.querySelector(".subtotal");
Â  Â  if (subtotalDiv) {
Â  Â  Â  subtotalDiv.textContent = `Subtotal: $${subtotalPulsera.toLocaleString("es-CO")} COP`;
Â  Â  }

Â  Â  totalGeneral += subtotalPulsera;
Â  });

Â  document.getElementById("total").textContent = `Total: $${totalGeneral.toLocaleString("es-CO")} COP`;
}

/* Generar resumen (CORREGIDO) */
function generarResumenTexto() {
Â  let resumen = "Resumen de pedido - The Family Store\n\n";
Â  let totalGeneral = 0;
Â  const pulseras = document.querySelectorAll(".pulsera");

Â  if (pulseras.length === 0) {
Â  Â  resumen += "No hay pulseras seleccionadas.\n\n";
Â  }

Â  pulseras.forEach((pulsera, i) => {
Â  Â  resumen += `Pulsera ${i+1}:\n`;
Â  Â  let subtotalPulsera = MANO_OBRA;

Â  Â  // CAMBIO CLAVE: Iterar sobre TODOS los inputs de cantidad
Â  Â  pulsera.querySelectorAll(".item-decoracion input[type='text']").forEach(input => {
Â  Â  Â  const cantidad = parseInt(input.value || "0", 10);
Â  Â  Â  if (cantidad > 0) {
Â  Â  Â  Â  // La funciÃ³n obtenerNombreYPrecio ahora solo necesita el input
Â  Â  Â  Â  const { nombre, precio } = obtenerNombreYPrecio(input);
Â  Â  Â  Â  const subtotalItem = cantidad * precio;
Â  Â  Â  Â  resumen += ` - ${nombre} ($${precio.toLocaleString("es-CO")}) x${cantidad} = $${subtotalItem.toLocaleString("es-CO")} COP\n`;
Â  Â  Â  Â  subtotalPulsera += subtotalItem;
Â  Â  Â  }
Â  Â  });

Â  Â  const notas = pulsera.querySelector(".notas")?.value.trim();
Â  Â  if (notas) resumen += `Â  Â Notas: ${notas}\n`;

Â  Â  resumen += ` Mano de obra: $${MANO_OBRA.toLocaleString("es-CO")} COP\n`;
Â  Â  resumen += ` Subtotal Pulsera ${i+1}: $${subtotalPulsera.toLocaleString("es-CO")} COP\n\n`;

Â  Â  totalGeneral += subtotalPulsera;
Â  });

Â  resumen += `Total: $${totalGeneral.toLocaleString("es-CO")} COP\n`;
Â  return { texto: resumen, total: totalGeneral };
}

/* Descargar PDF */
function descargarPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ unit: "pt", format: "a4" });

  const { texto } = generarResumenTexto();
  const lines = doc.splitTextToSize(texto, 520);

  doc.setFont("helvetica", "normal");
  doc.setFontSize(12);

  let y = 40;
  lines.forEach(line => {
    if (y > 800) {
      doc.addPage();
      y = 40;
    }
    doc.text(line, 40, y);
    y += 14;
  });

  doc.save("vale_compra.pdf");
}

/* Enviar por WhatsApp */
function enviarWhatsApp() {
  const { texto } = generarResumenTexto();
  const numero = WHATSAPP_NUM.replace(/\D/g, "");
  const url = `https://wa.me/${numero}?text=${encodeURIComponent(texto)}`;
  window.open(url, "_blank");
}

/* DelegaciÃ³n de eventos */
document.addEventListener("click", e => {
  if (e.target.classList.contains("mas")) {
    const input = e.target.parentElement.querySelector("input");
    input.value = parseInt(input.value || "0", 10) + 1;
    actualizarTotales();
  }

  if (e.target.classList.contains("menos")) {
    const input = e.target.parentElement.querySelector("input");
    input.value = Math.max(0, parseInt(input.value || "0", 10) - 1);
    actualizarTotales();
  }

  if (e.target.classList.contains("btn-borrar")) {
    e.target.closest(".pulsera").remove();
    actualizarTotales();
  }

  if (e.target.id === "agregarPulsera") {
    const contenedor = document.getElementById("pulseras");
    const primera = contenedor.querySelector(".pulsera");
    const copia = primera.cloneNode(true);

    copia.querySelectorAll("input").forEach(input => input.value = "0");
    copia.querySelectorAll("textarea").forEach(area => area.value = "");
    copia.querySelector(".subtotal").textContent = `Subtotal: $${MANO_OBRA.toLocaleString("es-CO")} COP`;

    contenedor.appendChild(copia);
    actualizarTotales();
  }
});

/* Inicializar totales */
document.addEventListener("DOMContentLoaded", actualizarTotales);
</script>

</body>
</html>




































